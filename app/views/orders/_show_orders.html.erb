<%= render partial:"users/sidebar" %>
<div class="alignment">
  <%= will_paginate(@orders, :renderer => WillPaginate::ActionView::LinkRenderer) %>
  <% @orders.each do |o|%>
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h5 class"panel-title">Order ID:- <%= o.id%></h5>
      </div>
      <div class="panel-body">
        <div>Recipient Name:- <%= o.full_name%></div>
        <div>shipping Address:- <%= o.shipping_address%></div>
        <div>Order Date:- <%= o.created_at%></div>
        <div>Ordered Products:-</div>
        <table  class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>Product Name</th>
              <th>Unit Price</th>
              <th>Quantity ordered</th>
              <th>Sub Total</th>
            </tr>
          </thead>
          <tbody>
            <%payable_amount=0%>   
            <% o.orderdetails.each do |d|%>
              <tr>
                <td> <%=d.product.name%> </td>
                <td> <%=d.product.price%> </td>
                <td> <%=d.quantity%> </td>
                <td> <%= d.product.price * d.quantity%> </td>
                <% payable_amount = payable_amount + d.product.price * d.quantity %>
              </tr>
            <%end%>
            <tr><td colspan="4">Total No. of Item => <%= o.orderdetails.length%></td></tr>
            <tr><td colspan="4">Payable Amount => <%= payable_amount%></td></tr>      
          </tbody>
        </table>
        <% if current_user.is_admin?%>
          <div>Order Status Is:- <%= o.order_status==false ? "Not Delivered" : "Delivered" %></div>
          <div style="width:150px;background-color:#F2FFD8">
            <lable>Change status</lable></br>
            <form action=<%= change_status_orders_path%> >
              <input type="hidden" name="order_id" value=<%= o.id%>>
              <input type="radio" name="status" value="true">Delivered</br>
              <input type="radio" name="status" value="false">Not Delivered
              <input type="submit" value="change status" class="btn btn-info">
            </form>
          </div></br>
          <%=link_to "Remove Order", order_path(o), method:"delete",class:"btn btn-danger"%>
        <%else%>
          <div>Order Status Is:- <%= o.order_status==false ? "Not Delivered" : "Delivered" %></div></br>      
        <%end%>
      </div>
    </div>
  <%end%>
  <%= will_paginate(@orders, :renderer => WillPaginate::ActionView::LinkRenderer) %>
</div>
