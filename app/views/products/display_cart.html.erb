<table id="table" class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <th>Item's</th>
      <th>Description</th>
      <th>Unit Price</th>
      <th>Quantity</th>
      <th>Sub total</th>
    </tr>
  </thead>
  <tbody>
    
    <% @products.each do |p| %>
      <tr id="product-<%=p.id%>">
        <td>
          <%= p.name%>
        </td>
        <td>
          <%= p.description%>
        </td>
        <td>
          <%= p.price%>
        </td>
        <td>
          <input type="text" id="qty-<%=p.id%>" value=1 style="width:80px" onchange='maketotal("<%=p.id%>","<%=p.price%>")'>
        </td>
        <td>
          <span id="subtotal-<%=p.id%>"><%=p.price%></span>
        </td>
        <td>
          <button id="removeitem-<%=p.id%>" onclick="removeitem('<%=p.id%>')" class="btn btn-warning">Remove</button>
        </td>
        
      </tr>
    <%end%>
  </tbody>
</table></br>
<div id="div1"></div>

<div style="background-color:#FFE0E0;height:100px;">
  <div id="totalitem">Cart Summary(<%= @products.length%>Item(s))</div></br>
  
  <% @x=0; 
       @products.each do |p|
       @x=@x+p.price
       end    
  %>
  
  <div id="payable_amount">Payable amount: <%= @x%></div>
  <%= link_to "Proceed to payment","/", class:"btn btn-info"%>  
</div>
<%= link_to "Back",root_path%>
<script>

function removeitem(id){
  $.get("/products/remove_from_cart?id="+id,function(){
   $("#product-"+id).remove();
   payable_amount();       
  }); 
}

function maketotal(id,price){
  $("#subtotal-"+id).text($("#qty-"+id).val()*price);
  payable_amount(); 
 }
 
function payable_amount(){
  var rows = $("#table td:nth-child(5)");
  amt=0;
  for(var i=0; i< rows.length;i++)
    {
      amt= amt + parseInt(rows[i].textContent);
    }
  $("#payable_amount").text("Payable amount:"+amt); 
} 
</script>












