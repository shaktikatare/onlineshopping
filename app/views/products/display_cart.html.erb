<table id="table" class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <th>Item's</th>
      <th>Description</th>
      <th>Unit Price</th>
      <th>Quantity</th>
      <th>Sub total</th>
    </tr>
  </thead>
  <tbody>
    <% @products.each do |p| %>
      <tr id="product-<%=p.id%>">
        <td>
          <%= p.name%>
        </td>
        <td>
          <%= p.description%>
        </td>
        <td>
          <%= p.price%>
        </td>
        <td>
          <select id="qty-<%=p.id%>" style="width:80px" onchange='maketotal("<%=p.id%>","<%=p.price%>")'>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </td>
        <td>
          <span>Rs. </span>
          <span id="subtotal-<%=p.id%>"><%=p.price%></span>
        </td>
        <td>
          <button id="removeitem-<%=p.id%>" onclick="removeitem('<%=p.id%>')">Remove</button>
        </td>
      </tr>
    <%end%>
  </tbody>
</table></br>
<div id="div1"></div>

<div style="background-color:#FFE0E0;height:100px;">
  <div>Cart Summary(<%= @products.length%>Items(s))</div></br>
  
  <% @x=0; 
       @products.each do |p|
       @x=@x+p.price
       end    
  %>
  
  <div id="payable_amount" value=<%= @x%>>Payable amount: <%= @x%></div>
  <%= link_to "Proceed to payment","/", class:"btn btn-info"%>  
</div>
<%= link_to "Back",root_path%>
<script>

function removeitem(id){
  $.get("/products/remove_from_cart?id="+id); 
}

function maketotal(id,price){
    $("#subtotal-"+id).text($("#qty-"+id).val()*price);
    amt=0;
    <% @products.each do |p|%>
       amt= amt + parseInt($("#subtotal-"+<%=p.id%>).html());
    <%end%>     
    $("#payable_amount").text("Payable amount:"+amt); 
   }
</script>









