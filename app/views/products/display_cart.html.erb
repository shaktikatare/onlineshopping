<table id="table" class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <th>Item's</th>
      <th>Description</th>
      <th>Unit Price</th>
      <th>Quantity</th>
      <th>Sub total</th>
    </tr>
  </thead>
  <tbody>
    
    <% @cart.each do |c| %>
      <% product=Product.find(c.product_id) %>
      <tr id="product-<%=product.id%>">
        <td>
          <%= product.name%>
        </td>
        <td>
          <%= product.description%>
        </td>
        <td>
          <%= product.price%>
        </td>
        <td>
          <input type="text" id="qty-<%=product.id%>" value="<%=c.qty%>"style="width:80px" 
          onchange='maketotal_update_qty("<%=product.id%>","<%=product.price%>","<%=c.id%>")'>
        </td>
        <td>
          <span id="subtotal-<%=product.id%>"><%= product.price * c.qty%></span>
        </td>
        <td>
          <button id="removeitem-<%=product.id%>" onclick="removeitem('<%=product.id%>')" class="btn btn-warning">Remove</button>
        </td>
        
      </tr>
    <%end%>
  </tbody>
</table></br>
<div id="div1"></div>

<div style="background-color:#FFE0E0;height:100px;">
  <div id="totalitem">Cart Summary(<%= @cart.length%>Item(s))</div></br>
  <div id="payable_amount"></div>
  <%= link_to "Proceed to payment",new_order_path, class:"btn btn-info"%>  
</div>
<%= link_to "Back",product_path(:id=>@category_id)%>
<script>
  
  $(document).ready(function(){
    payable_amount();
  });
  
  function removeitem(id){
    $.get("/products/remove_from_cart?id="+id,function(){
      $("#product-"+id).remove();
      payable_amount();       
    }); 
  }

  function maketotal_update_qty(pid,price,cid){
    $("#subtotal-"+pid).text($("#qty-"+pid).val()*price);
    payable_amount();
    $.get("/products/update_qty?id="+cid+"&qty="+$("#qty-"+pid).val(),function(){
    });
  }
   
  function payable_amount(){
    var rows = $("#table td:nth-child(5)");
    amt=0;
    for(var i=0; i< rows.length;i++)
      {
        amt= amt + parseInt(rows[i].textContent);
      }
    $("#payable_amount").text("Payable amount:"+amt); 
  }
</script>












